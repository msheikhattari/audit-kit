# Compilation and Testing
Contract compilation can be expected to take 10+ minutes. According to the team, this is expected. via-ir was enabled and in fact necessary, as a stack error is thrown otherwise. The maximum number of optimization steps were used. The team noted that if the number of optimizations are turned down it may be faster, though the bytecode being tested against could differ from prod. Recommended course of action: give the contracts time to compile, rather than making any changes. Analyst found that it took roughly 22 minutes to compile all of the contracts.

After contract compilation, it took about 10 minutes to run the 172 tests in the testing suite. Some tests take substantially longer than others to run, so the use of --match-test or --match-contract flags is advised. Initial testing resulted in 11 failing tests. Nine of the tests were failing due to uninitialized environment variables. Create a .env file in aloe-ii/core, with the following variables defined: RPC_URL_OPTIMISM and RPC_URL_MAINNET. The other 2 failing tests were resulting from foundry's ffi cheatcode, which requires the --ffi flag, so it's recommended to include this when running the tests.

When generating test coverage files, the instrumentaton causes stack too deep in a few files. Some of the files were excluded before trying to get coverage, and the team mentions that this is to be expected. The test.sh file contains 5 files which are excluded when generating coverage files: "test/libraries/Oracle.t.sol", "test/libraries/Volatility.t.sol", "test/invariants/LenderHarness.t.sol", "test/invariants/LenderInvariants.t.sol", and "test/VolatilityOracle.t.sol". While these are all test files rather than critical protocol code, the auditors should keep in mind that they are excluded from the coverage report. The coverage report is included under the 'coverage' folder.
